% From https://www.sharelatex.com/learn/Typing_exams_in_LaTeX
% 
% To produce pdf run:
%   $ pdflatex paper.tex 
%

\documentclass[10pt]{exam}

\usepackage{listings}
\lstset{basicstyle=\footnotesize\ttfamily,breaklines=true}
 
% These do what you would expect:
\printanswers
%\noprintanswers

\begin{document}
 
\title{SQL Workshop Day 1}
\author{UC Davis DSI}
\date{May 4, 2018}

\maketitle

\begin{questions}

\question How many tables are in the database?

\begin{solution}
    7. Look under `Database Structure' tab.
\end{solution}


\question Select all fields in the `company` table.

\begin{solution}
\begin{lstlisting}
SELECT *
FROM company
;
\end{lstlisting}
\end{solution}


\question Which table has the most rows? The fewest rows?

\begin{solution}

    Count rows using:

\begin{lstlisting}
SELECT COUNT(*)
FROM daily_share_prices  -- replace with name of each table
;
\end{lstlisting}
\end{solution}


\question Write a query so that the fields in \texttt{financial\_ratios} table
appear in alphabetical order.

\begin{solution}
\begin{lstlisting}
SELECT beta
    , dividend_yield
    , market_cap_in_millions
    , price_earnings_ratio
    , price_to_book_ratio
    , return_on_equity
    , share_price
    , ticker
FROM financial_ratios
;
\end{lstlisting}
\end{solution}


    \question Which company has the least expensive stock in the
    \texttt{financial\_ratios} table?

\begin{solution}
\begin{lstlisting}
SELECT ticker, share_price
FROM financial_ratios
ORDER BY share_price
LIMIT 1
;
\end{lstlisting}
\end{solution}

    \question Which company has the most expensive stock in the
    \texttt{financial\_ratios} table?

\begin{solution}
\begin{lstlisting}
SELECT ticker, share_price
FROM financial_ratios
ORDER BY share_price DESC
LIMIT 1
;
\end{lstlisting}
\end{solution}


\end{questions}

\end{document}
